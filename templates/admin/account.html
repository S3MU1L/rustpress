{% extends "layouts/base.html" %}

{% block title %}Account - RustPress{% endblock %}

{% block header %}
{% include "partials/nav_admin.html" %}
{% endblock %}

{% block content %}
<div class="max-w-2xl">
  <div class="mb-6">
    <h1 class="mb-2">Account Settings</h1>
    <p class="text-rp-muted">Manage your account information.</p>
  </div>

  {% if error.is_some() %}
    <div class="notice notice-error mb-4">
      <p class="m-0">{{ error.as_ref().unwrap() }}</p>
    </div>
  {% endif %}

  {% if success.is_some() %}
    <div class="notice notice-success mb-4">
      <p class="m-0">{{ success.as_ref().unwrap() }}</p>
    </div>
  {% endif %}

  <div class="card p-5 mb-6">
    <h2 class="text-lg mb-4">Email Address</h2>
    <form method="post" action="/admin/me/account/email" hx-post="/admin/me/account/email" hx-target="body" hx-swap="outerHTML">
      <label>
        Email
        <input name="email" type="email" value="{{ user.email }}" />
      </label>

      <div class="flex items-center gap-3 mt-4">
        <button class="btn-primary" type="submit">Save Email</button>
      </div>
    </form>

    <div class="mt-4 pt-4 border-t border-rp-border">
      <p class="text-rp-muted text-sm">
        Email verified:
        {% if user.email_verified_at.is_some() %}
          <span class="badge badge-success">Yes</span>
        {% else %}
          <span class="badge">No</span>
        {% endif %}
      </p>
    </div>
  </div>

  <div class="card p-5 mb-6">
    <h2 class="text-lg mb-4">Change Password</h2>
    <form method="post" action="/admin/me/account/password" hx-post="/admin/me/account/password" hx-target="body" hx-swap="outerHTML">
      <div class="space-y-4">
        <label>
          Current Password
          <input type="password" name="current_password" required />
        </label>
        <label>
          New Password
          <input type="password" name="new_password" required placeholder="At least 4 characters" minlength="4" />
        </label>
      </div>
      <div class="mt-4">
        <button class="btn-primary" type="submit">Update Password</button>
      </div>
    </form>
  </div>

  <div class="flex items-center gap-3">
    <a class="btn-secondary" href="/admin">Back to Dashboard</a>
    <a class="btn-secondary" href="/admin/me/security">Security Settings</a>
  </div>
</div>
{% endblock %}
