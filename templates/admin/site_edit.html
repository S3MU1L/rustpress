{% extends "layouts/base.html" %}

{% block title %}Edit Site - {{ site.name }} - RustPress{% endblock %}

{% block header %}
{% include "partials/nav_admin.html" %}
{% endblock %}

{% block content %}
<div class="max-w-2xl">
  <div class="flex items-center justify-between mb-6">
    <div>
      <h1 class="mb-1">Edit Site</h1>
      <div class="flex items-center gap-2">
        <span class="badge {% if site.status == "published" %}badge-success{% endif %}">{{ site.status }}</span>
      </div>
    </div>
    <a class="btn-secondary" href="/admin/sites">Back to Sites</a>
  </div>

  {% if error.is_some() %}
    <div class="notice notice-error mb-4">
      <p class="m-0">{{ error.as_ref().unwrap() }}</p>
    </div>
  {% endif %}

  {% if success.is_some() %}
    <div class="notice notice-success mb-4">
      <p class="m-0">{{ success.as_ref().unwrap() }}</p>
    </div>
  {% endif %}

  <!-- Site Settings -->
  <div class="card p-5 mb-6">
    <h2 class="text-lg mb-4">Site Settings</h2>
    <form method="post" action="/admin/sites/{{ site.id }}" hx-post="/admin/sites/{{ site.id }}" hx-target="body" hx-swap="outerHTML">
      <label>
        Site Name
        <input name="name" value="{{ site.name }}" />
      </label>

      <label>
        Slug
        <input name="slug" value="{{ site.slug }}" />
      </label>

      <label>
        Default Template
        <select name="default_template">
          {% for t in templates %}
            <option value="{{ t.name }}" {% if t.name == site.default_template %}selected{% endif %}>{{ t.name }}{% if t.is_builtin %} (built-in){% endif %}</option>
          {% endfor %}
        </select>
        <p class="text-rp-muted text-sm mt-1">Or browse <a href="/admin/themes?site_id={{ site.id }}">Themes</a> to apply a different template.</p>
      </label>

      <div class="mt-4">
        <button class="btn-primary" type="submit">Save Changes</button>
      </div>
    </form>
  </div>

  <!-- Publishing -->
  <div class="card p-5">
    <h2 class="text-lg mb-4">Publishing</h2>
    <p class="text-rp-muted text-sm mb-4">Current status: <strong>{{ site.status }}</strong></p>
    <form method="post" action="/admin/sites/{{ site.id }}/publish" hx-post="/admin/sites/{{ site.id }}/publish" hx-target="body" hx-swap="outerHTML">
      <button class="btn-primary" type="submit">Publish Site</button>
    </form>
  </div>
</div>
{% endblock %}
