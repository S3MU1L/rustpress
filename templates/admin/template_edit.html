{% extends "layouts/base.html" %}

{% block title %}Edit Template - {{ template.name }} - RustPress{% endblock %}

{% block header %}
{% include "partials/nav_admin.html" %}
{% endblock %}

{% block content %}
<div class="max-w-3xl">
  <div class="flex items-center justify-between mb-6">
    <div>
      <h1 class="mb-1">Edit Template</h1>
      <div class="flex items-center gap-2">
        <span class="text-rp-muted">{{ template.name }}</span>
        {% if template.is_builtin %}
          <span class="badge">Built-in</span>
        {% else %}
          <span class="badge badge-success">Custom</span>
        {% endif %}
      </div>
    </div>
    <a class="btn-secondary" href="/admin/templates">Back to Templates</a>
  </div>

  {% if template.is_builtin %}
    <div class="notice notice-warning mb-6">
      <p class="m-0">Built-in templates are read-only. Create a copy to make changes.</p>
    </div>
  {% endif %}

  <!-- Edit Form -->
  <div class="card p-5 mb-6">
    <h2 class="text-lg mb-4">Template Settings</h2>
    <form method="post" action="/admin/templates/{{ template.id }}" hx-post="/admin/templates/{{ template.id }}" hx-target="body" hx-swap="outerHTML">
      <label>
        Name
        <input name="name" value="{{ template.name }}" {% if template.is_builtin %}disabled{% endif %} />
      </label>

      <label>
        Description
        <input name="description" value="{{ template.description }}" {% if template.is_builtin %}disabled{% endif %} />
      </label>

      <label>
        HTML
        <textarea name="html" rows="18" class="font-mono text-sm" {% if template.is_builtin %}disabled{% endif %}>{{ template.html }}</textarea>
      </label>

      <div class="mt-4">
        <button class="btn-primary" type="submit" {% if template.is_builtin %}disabled{% endif %}>Save Changes</button>
      </div>
    </form>
  </div>

  {% if template.is_builtin %}
    <!-- Duplicate Form -->
    <div class="card p-5 mb-6">
      <h2 class="text-lg mb-2">Make a Copy</h2>
      <p class="text-rp-muted text-sm mb-4">Create a custom copy of this template that you can edit.</p>
      <form method="post" action="/admin/templates/{{ template.id }}/duplicate" hx-post="/admin/templates/{{ template.id }}/duplicate" hx-swap="none">
        <button class="btn-primary" type="submit">Copy as Custom Template</button>
      </form>
    </div>
  {% endif %}

  {% if !template.is_builtin %}
    <p class="text-rp-muted text-sm">
      Placeholders: <code class="bg-rp-bg px-1 rounded text-sm">{{"{{title}}"}}</code>,
      <code class="bg-rp-bg px-1 rounded text-sm">{{"{{content}}"}}</code>,
      <code class="bg-rp-bg px-1 rounded text-sm">{{"{{slug}}"}}</code>,
      <code class="bg-rp-bg px-1 rounded text-sm">{{"{{kind}}"}}</code>
    </p>
  {% endif %}
</div>
{% endblock %}
